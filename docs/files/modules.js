(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{6:function(t,n,e){(function(n){function e(){return l.Date.now()}var r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,u=parseInt,c="object"==typeof n&&n&&n.Object===Object&&n,l=(n="object"==typeof self&&self&&self.Object===Object&&self,c||n||Function("return this")()),s=Object.prototype.toString,f=Math.max,p=Math.min;function d(t){var n=typeof t;return t&&("object"==n||"function"==n)}function m(t){if("number"==typeof t)return t;if("symbol"==typeof(n=t)||(e=n)&&"object"==typeof e&&"[object Symbol]"==s.call(n))return NaN;var n,e;if("string"!=typeof(t=d(t)?d(c="function"==typeof t.valueOf?t.valueOf():t)?c+"":c:t))return 0===t?t:+t;t=t.replace(r,"");var c=o.test(t);return c||a.test(t)?u(t.slice(2),c?2:8):i.test(t)?NaN:+t}t.exports=function(t,n,r){var i,o,a,u,c,l,s=0,g=!1,v=!1,y=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function h(n){var e=i,r=o;return i=o=void 0,s=n,u=t.apply(r,e)}function b(t){var e=t-l;return void 0===l||n<=e||e<0||v&&a<=t-s}function _(){var t,r=e();if(b(r))return S(r);c=setTimeout(_,(r=n-((t=r)-l),v?p(r,a-(t-s)):r))}function S(t){return c=void 0,y&&i?h(t):(i=o=void 0,u)}function w(){var t=e(),r=b(t);if(i=arguments,o=this,l=t,r){if(void 0===c)return s=r=l,c=setTimeout(_,n),g?h(r):u;if(v)return c=setTimeout(_,n),h(l)}return void 0===c&&(c=setTimeout(_,n)),u}return n=m(n)||0,d(r)&&(g=!!r.leading,a=(v="maxWait"in r)?f(m(r.maxWait)||0,n):a,y="trailing"in r?!!r.trailing:y),w.cancel=function(){void 0!==c&&clearTimeout(c),i=l=o=c=void(s=0)},w.flush=function(){return void 0===c?u:S(e())},w}}).call(this,e(7))},7:function(t,n){var e=function(){return this}();try{e=e||new Function("return this")()}catch(t){"object"==typeof window&&(e=window)}t.exports=e},8:function(t,n,e){"use strict";e.r(n),e.d(n,"default",(function(){return st}));var r,i=e(2),o=e.n(i),a=window.tpBar,u=function(t,n,e){return e=o()("div.tp-bar__button",{title:n},o()("img",{src:t,alt:n}),{onclick:e}),a.append(e),e},c=e.p+"images/close.png";function l(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return s(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(e="Object"===e&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?s(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function f(){r&&(r(),r=null)}var p=o()("div.tp-panel.is-hidden"),d=o()("div.tp-panel__header"),m=o()("div.tp-panel__content"),g=o()("div.tp-panel__close",{onclick:function(){p.classList.add("is-hidden"),f()}},o()("img.tp-panel__img",{src:c,alt:"Close panel"})),v=o()("div.tp-panel__headline",d,g);p.append(v,m),document.body.append(p);var y=function(t,n,e){var i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];e=Array.isArray(e)?e:[e];r!==n&&f(),r=n,d.textContent=t,p.classList.remove("is-hidden"),p.classList.toggle("tp-panel--partial",i),m.replaceChildren.apply(m,l(e))},h=function(){p.classList.add("is-hidden"),f()},b=e.p+"images/about.png",_=e.p+"images/center.png",S=(n=e.p+"images/currentLocation.png",i=e.p+"images/custom.png",c=e.p+"images/measure.png",g=e.p+"images/minus.png",v=e.p+"images/plus.png",{about:b,center:_,custom:i,measure:c,currentLocation:n,settings:e.p+"images/settings.png",plus:v,minus:g}),w="tracker-poznan-about1",A="Loading";fetch("data/info.json").then((function(t){return t.json()})).then((function(t){t=t.dataUpdate,A=t}));var L=e(1),I=function(t,n){n=n.map((function(t){return[t.latitude,t.longitude]})),n=Object(L.c)(n),t.fitBounds(n)},j=function(t,n){t.flyTo(n)},O=[52.40777954910866,16.912470459938053],k=e(3),M=[],C="tracker-poznan-settings3",x=JSON.parse(localStorage.getItem(C)||'{"items":{}}');function E(){M.forEach((function(t){return t()})),localStorage.setItem(C,JSON.stringify(x))}function T(t,n,e){x.items[n.id]||(x.items[n.id]={}),x.items[n.id][t]=e,E()}var P,U={changeVisibility:T.bind(null,"isVisible"),changeMeasuring:T.bind(null,"isMeasured"),changeRange:T.bind(null,"showRange"),setShopLimit:function(t){x.shopLimit=t,E()},getShopLimit:function(){return x.shopLimit||0},addCallback:M.push.bind(M),getSetting:function(t){return x.items[t]||{}}};function Z(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}}(t,n)||function(t,n){if(t){if("string"==typeof t)return $(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(e="Object"===e&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?$(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var F=[];function R(){var t,n,e,r=0<arguments.length&&void 0!==arguments[0]&&arguments[0];P&&(n=k.a.filter((function(t){return U.getSetting(t.id).isMeasured})),t=U.getShopLimit(),n.forEach((function(t){var n=t.items.map((function(t){return[Object(L.d)(P,[t.latitude,t.longitude]),t]}));n.sort((function(t,n){return Z(t,1)[0]-Z(n,1)[0]})),t.closest=n.slice(0,t.measureCount)})),0<t&&(n=n.filter((function(t){return"shop"===t.category})),e=n.flatMap((function(t){return t.closest})).sort((function(t,n){return Z(t,1)[0]-Z(n,1)[0]})).slice(0,t).reduce((function(t,n){return t.has(n[1].group)?t.get(n[1].group).push(n):t.set(n[1].group,[n]),t}),new Map),n.forEach((function(t){t.closest=e.get(t)||[]}))),r||F.forEach((function(t){return t()})))}U.addCallback((function(){return R(!1)}));var V=function(t){var n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];P=t,R(!0),n||F.forEach((function(t){return t()}))},z=function(){return P},N=function(t){F.push(t)},D=(g=e(0),e.n(g));function J(t){return function(t){if(Array.isArray(t))return q(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||W(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}}(t,n)||W(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(t,n){if(t){if("string"==typeof t)return q(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(e="Object"===e&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?q(t,n):void 0}}function q(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var B=D.a.icon({iconUrl:S.currentLocation,iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,0]}),K=[];function G(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}}(t,n)||function(t,n){if(t){if("string"==typeof t)return Y(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(e="Object"===e&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Y(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Q(t){k.a.forEach((function(n){var e=U.getSetting(n.id);e.isVisible?t.addLayer(n.layer):t.removeLayer(n.layer),n.rangeLayers.forEach((function(n){return n=G(n,2)[1],t.removeLayer(n)})),(n=n.rangeLayers.find((function(t){return G(t,1)[0]==e.showRange})))&&t.addLayer(n[1])}))}function X(t,n){if(t){if("string"==typeof t)return tt(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(e="Object"===e&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?tt(t,n):void 0}}function tt(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function nt(t,n,e){return n.length?[o()("div.tp-panel__header",t)].concat(function(t){return function(t){if(Array.isArray(t))return tt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||X(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(n.flatMap((function(t){return[o()("div.measure-subheader",t.label),o()("ol",t.closest.map((function(t){var n=(r=function(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}}(t,n)||X(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2))[0],r=(t=r[1]).label,i=t.latitude,a=t.longitude;t=void 0===(t=t.closestLines)?[]:t;return o()("li.measure-link","".concat(r," (").concat((1e3*n).toFixed(0),"m)").concat(t.length?": ":"").concat(t.join(", ")),{onclick:function(){return j(e,[i,a])}})})))]})))):[]}g=e(6),g=e.n(g);var et=e(4),rt=g()((function(t){t=(n=t.target).getCenter();var n=n.getZoom();et.a.saveLatLngZoom(t,n)}),100);function it(t,n){if(t){if("string"==typeof t)return ot(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(e="Object"===e&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?ot(t,n):void 0}}function ot(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var at=[0,1,2,3,4,5].map((function(t){return{value:t,label:0===t?"None":t.toString()}})),ut=[{id:"transport",label:"Transport",groups:k.a.filter((function(t){return"transport"===t.category}))},{id:"shops",label:"Shops",groups:k.a.filter((function(t){return"shop"===t.category})),allowLimit:!0},{id:"misc",label:"Miscellaneous",groups:k.a.filter((function(t){return"misc"===t.category}))}];function ct(t){var n=U.getSetting(t.id);return o()("div.tp-settings-group",o()("img.tp-settings-group__img",{src:t.iconUrl,alt:t.label}),o()("div.tp-settings-group__info",o()(".tp-settings-group__label",t.label,{style:{color:t.color}}),o()(".tp-settings__detail","".concat(t.items.length," items"))),o()("label.tp-settings-group__cell",o()("input",{type:"checkbox",checked:!!n.isVisible,onchange:function(n){return U.changeVisibility(t,n.target.checked)}}),o()("div","Display")),o()("label.tp-settings-group__cell",o()("input",{type:"checkbox",checked:!!n.isMeasured,onchange:function(n){return U.changeMeasuring(t,n.target.checked)}}),o()("div.tp-settings-group__text","Measure")),o()("div.tp-settings-group__cell",1<t.rangeLayers.length?[o()("select",{onchange:function(n){return U.changeRange(t,n.target.value)},value:n.showRange||0},t.rangeLayers.map((function(t){return t=function(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,o=[],a=!0,u=!1;try{for(e=e.call(t);!(a=(r=e.next()).done)&&(o.push(r.value),!n||o.length!==n);a=!0);}catch(t){u=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(u)throw i}}return o}}(t,n)||it(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,1)[0],o()("option","".concat(t,"m"),{value:t,selected:n.showRange==t})}))),o()("div.tp-settings-group__text","Reach")]:[]))}var lt=[function(t){var n,e;n=t,et.a.wasRestored()||(e=((e=k.a.filter((function(t){return U.getSetting(t.id).isVisible}))).length?e:k.a).flatMap((function(t){return t.items})),I(n,e)),t.on("zoomend",rt),t.on("moveend",rt)},function(t){function n(n){var i=t.getMaxZoom(),o=t.getMinZoom();n=t.getZoom()+n;e.classList.toggle("is-disabled",!(n<i)),r.classList.toggle("is-disabled",!(o<n))}var e=u(S.plus,"Zoom in",(function(){t.zoomIn(),n(1)})),r=u(S.minus,"Zoom out",(function(){t.zoomOut(),n(-1)}));n(0)},function(){var t=u(S.settings,"Settings",(function(){t.classList.contains("is-active")?(h(),t.classList.remove("is-active")):(t.classList.add("is-active"),y("Settings",(function(){return t.classList.remove("is-active")}),ut.flatMap((function(t){return[o()("div.tp-panel__subheader",t.label),t.allowLimit?o()("div.tp-settings__limit",[o()("div","Limit total measured shops to: "),o()("select",{onchange:function(t){return U.setShopLimit(t.target.value)},value:U.getShopLimit()},at.map((function(t){var n=t.value;t=t.label;return o()("option",t,{value:n,selected:n==U.getShopLimit()})})))]):[]].concat(function(t){return function(t){if(Array.isArray(t))return ot(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||it(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.groups.map(ct)))})).flat()))}))},function(t){var n=u(S.measure,"Show distances",(function(){n.classList.contains("is-active")?(h(),n.classList.remove("is-active")):e()}));function e(){var e=function(t){var n=z();if(!n)return o()("div.tutorial",o()("div.tp-panel__subheader","Select a point on map using one of the options:"),o()("div.tutorial__item",o()("img.tutorial__icon",{src:S.custom,alt:"Click on map"}),"Click on map to find closest POIs"),o()("div.tutorial__item",o()("img.tutorial__icon",{src:S.currentLocation,alt:"Current location"}),"Use current location to find closest POIs"));if(!(i=k.a.filter((function(t){return U.getSetting(t.id).isMeasured&&t.closest.length}))).length)return o()("div.tutorial__item",o()("img.tutorial__icon",{src:S.settings,alt:"Settings"}),"Set some measured POIs");var e=i.filter((function(t){return"transport"===t.category})),r=i.filter((function(t){return"shop"===t.category})),i=i.filter((function(t){return"misc"===t.category}));return[o()(".measure-link.measure-header","Selected: ".concat(n.map((function(t){return t.toFixed(5)})).join(","))),nt("Transport",e,t),nt("Shops",r,t),nt("Miscellaneous",i,t)].flat()}(t);y("Closest points",(function(){return n.classList.remove("is-active")}),e,!0),n.classList.add("is-active")}function r(){n.classList.contains("is-active")&&e()}N(r),U.addCallback(r)},function(t){U.addCallback((function(){return Q(t)})),Q(t)},function(t){function n(n){var e=0<arguments.length&&void 0!==n&&n;K.forEach((function(t){return t.remove()})),K=[];var r,i,o,a,u,c=z();c&&(r=u=k.a.filter((function(t){return!!U.getSetting(t.id).isMeasured})),i=t,o=c,a=new D.a.Marker(o,{icon:B,opacity:.8}),n=r.map((function(t){return D.a.polyline([t.closest.map((function(t){return[[(t=H(t,2)[1]).latitude,t.longitude],o]}))],{weight:2,color:t.color,dashArray:[4,4]})})),r=D.a.layerGroup(r.filter((function(t){return!U.getSetting(t.id).isVisible})).flatMap((function(t){return t.closest.map((function(n){return n=H(n,2)[1],D.a.marker([n.latitude,n.longitude],{icon:t.iconLayer,opacity:.8}).bindPopup(n.popupHtml)}))}))),K.push.apply(K,J(n).concat([r,a])),K.forEach((function(t){return i.addLayer(t)})),e&&(u=u.flatMap((function(t){return t.closest.map((function(t){return H(t,2)[1]}))})),I(t,[].concat(J(u),[{latitude:c[0],longitude:c[1]}]))))}N((function(){return n(!1)})),U.addCallback((function(){return n(!0)}))},function(t){var n;function e(n){n=(e=n.coords).latitude;var e=e.longitude;t.setView([n,e]),V([n,e])}function r(){alert("Unable to follow your location")}var i=u(S.currentLocation,"Follow current location",(function(){var t=!i.classList.contains("is-active");i.classList.toggle("is-active",t),t&&!n&&(n=navigator.geolocation.watchPosition(e,r,{enableHighAccuracy:!0,maximumAge:5e3})),!t&&n&&(navigator.geolocation.clearWatch(n),n=null)}))},function(t){function n(t){V([t.latlng.lat,t.latlng.lng])}var e=u(S.custom,"Click on map",(function(){var r=e.classList.contains("is-active");e.classList.toggle("is-active",!r),window.tpMap.style.cursor=r?"":"pointer",t.off("click",n),r||t.on("click",n)}))},function(t){u(S.center,"Center on Kaponiera",(function(){j(t,O)}))},function(){var t=u(S.about,"About",(function(){t.classList.contains("is-active")?(h(),t.classList.remove("is-active")):n()}));function n(){t.classList.add("is-active"),y("Poznan tracker",(function(){return t.classList.remove("is-active")}),[o()("p","Find closest communication, shops and other POI (Points Of Interest)."),o()("p","Last updated ".concat(A)),o()("div.tp-panel__header","Terms of use"),o()("ol",o()("li","You're using this application on your own."),o()("li","I claim no rights to the presented data."),o()("li","I take no responsibility for any actions based on this app or its contents."),o()("li","Data was collected using resources available on the internet.")),o()("div.tp-panel__header","Usage"),o()("div.tutorial",o()("div.tutorial__item",o()("img.tutorial__icon",{src:S.plus,alt:"Zoom in"}),"Zoom in"),o()("div.tutorial__item",o()("img.tutorial__icon",{src:S.minus,alt:"Zoom out"}),"Zoom out"),o()("div.tutorial__item",o()("img.tutorial__icon",{src:S.settings,alt:"Settings"}),"Change displayed and measured POIs"),o()("div.tutorial__item",o()("img.tutorial__icon",{src:S.measure,alt:"Measure details"}),"Display details about closest POIs"),o()("div.tutorial__item",o()("img.tutorial__icon",{src:S.custom,alt:"Click on map"}),"Click on map to find closest POIs"),o()("div.tutorial__item",o()("img.tutorial__icon",{src:S.currentLocation,alt:"Current location"}),"Follow current location to find closest POIs"),o()("div.tutorial__item",o()("img.tutorial__icon",{src:S.center,alt:"Center"}),"Focus map on the Kaponiera"),o()("div.tutorial__item",o()("img.tutorial__icon",{src:S.about,alt:"About"}),"Show this panel again")),o()("div.tp-panel__header","Measuring distances"),o()("p","Distances are measured in straight line - no obstacles are taken into account (rivers, roads, etc.).\nFinding closest points would require a payed API, with a lot of requests needed."),o()("div.tp-panel__header","Have fun!")])}localStorage.getItem(w)||(n(),localStorage.setItem(w,"1"))}];function st(t){lt.forEach((function(n){return n(t)}))}}}]);